import{j as e,C as L,aH as T,ao as $}from"./vendor-ui-B6CU6qF1.js";import{R as B,r as d}from"./vendor-react-DtEkOSI3.js";import{a as u}from"./index-XBRr7Ttx.js";const O=["일","월","화","수","목","금","토"],R=["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],H=B.memo(function({subscriptions:k=[],onSelectDate:A}){const[b,f]=d.useState(new Date),[c,y]=d.useState(null),o=b.getFullYear(),n=b.getMonth(),x=d.useMemo(()=>{const t=new Date(o,n,1),r=new Date(o,n+1,0),l=t.getDay(),g=r.getDate(),a={};return k.forEach(s=>{if(s.billingDay&&!s.isPaused){const i=Math.min(s.billingDay,g);i>=1&&(a[i]||(a[i]=[]),a[i].push(s))}}),{startingDay:l,daysInMonth:g,subscriptionsByDay:a}},[k,o,n]),N=d.useCallback(()=>{f(new Date(o,n-1,1)),y(null)},[o,n]),w=d.useCallback(()=>{f(new Date(o,n+1,1)),y(null)},[o,n]),m=d.useMemo(()=>new Date,[]),D=d.useCallback(t=>t===m.getDate()&&n===m.getMonth()&&o===m.getFullYear(),[m,n,o]),j=d.useCallback(t=>(t==null?void 0:t.reduce((r,l)=>r+(l.cost||0),0))||0,[]),C=d.useCallback((t,r)=>{r&&r.length>0&&y(l=>l===t?null:t)},[]),S=()=>{const t=[],{startingDay:r,daysInMonth:l,subscriptionsByDay:g}=x;for(let a=0;a<r;a++)t.push(e.jsx("div",{className:"h-14 sm:h-16"},`empty-${a}`));for(let a=1;a<=l;a++){const s=g[a],i=s&&s.length>0,v=j(s),M=c===a,p=D(a);t.push(e.jsxs("button",{onClick:()=>C(a,s),className:`relative h-14 sm:h-16 rounded-2xl flex flex-col items-center justify-center transition-all duration-200 group ${p?"bg-gradient-to-br from-primary-100 to-violet-100 dark:from-primary-900/40 dark:to-violet-900/30 ring-2 ring-primary-500 shadow-lg shadow-primary-500/20":M?"bg-primary-50 dark:bg-primary-900/20 ring-1 ring-primary-300 dark:ring-primary-700":i?"bg-gray-50 dark:bg-dark-700/50 hover:bg-gray-100 dark:hover:bg-dark-700 hover:scale-105":"hover:bg-gray-50 dark:hover:bg-dark-700/30"}`,title:i?`${s.length}개 구독, ${v.toLocaleString()}원`:void 0,children:[p&&e.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 px-1.5 py-0.5 bg-primary-500 text-white text-[8px] font-bold rounded-full shadow-sm",children:"TODAY"}),e.jsx("span",{className:`text-sm font-semibold ${p?"text-primary-700 dark:text-primary-300":"text-gray-700 dark:text-dark-300"}`,children:a}),i&&e.jsxs("div",{className:"flex items-center gap-0.5 mt-1",children:[s.slice(0,3).map((h,E)=>e.jsx("div",{className:"w-2 h-2 rounded-full transition-transform group-hover:scale-125",style:{backgroundColor:h.customColor||u[h.category]||"#6366f1",boxShadow:`0 0 4px ${h.customColor||u[h.category]||"#6366f1"}60`}},E)),s.length>3&&e.jsxs("span",{className:"text-[9px] font-medium text-gray-400 ml-0.5",children:["+",s.length-3]})]}),i&&e.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:e.jsxs("div",{className:"px-2 py-0.5 bg-gray-900 dark:bg-white text-white dark:text-gray-900 text-[10px] font-medium rounded-full whitespace-nowrap shadow-lg",children:[v.toLocaleString(),"원"]})})]},a))}return t};return e.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-2xl shadow-sm border border-gray-100 dark:border-dark-700 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-100 dark:border-dark-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-primary-100 dark:bg-primary-900/30 rounded-xl",children:e.jsx(L,{size:18,className:"text-primary-600 dark:text-primary-400"})}),e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:"결제 캘린더"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:N,className:"p-2 hover:bg-gray-100 dark:hover:bg-dark-700 rounded-lg transition-colors",children:e.jsx(T,{size:18,className:"text-gray-500 dark:text-dark-400"})}),e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white min-w-[100px] text-center",children:[o,"년 ",R[n]]}),e.jsx("button",{onClick:w,className:"p-2 hover:bg-gray-100 dark:hover:bg-dark-700 rounded-lg transition-colors",children:e.jsx($,{size:18,className:"text-gray-500 dark:text-dark-400"})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:O.map((t,r)=>e.jsx("div",{className:`text-center text-xs font-medium py-2 ${r===0?"text-red-400":r===6?"text-blue-400":"text-gray-400 dark:text-dark-500"}`,children:t},t))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:S()})]}),c&&x.subscriptionsByDay[c]&&e.jsx("div",{className:"px-4 pb-4 animate-slide-up",children:e.jsxs("div",{className:"bg-gray-50 dark:bg-dark-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[n+1,"월 ",c,"일 결제"]}),e.jsxs("span",{className:"text-primary-600 dark:text-primary-400 font-bold",children:[j(x.subscriptionsByDay[c]).toLocaleString(),"원"]})]}),e.jsx("div",{className:"space-y-2",children:x.subscriptionsByDay[c].map(t=>{var r,l;return e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white dark:bg-dark-800 rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:t.customColor||u[t.category]||"#6366f1"},children:(r=t.name)==null?void 0:r.slice(0,1).toUpperCase()}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:t.name})}),e.jsxs("div",{className:"text-sm font-semibold text-gray-700 dark:text-dark-300",children:[(l=t.cost)==null?void 0:l.toLocaleString(),"원"]})]},t.id)})})]})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-dark-400",children:[e.jsx("span",{children:"이번 달 예정 결제"}),e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[Object.values(x.subscriptionsByDay||{}).flat().reduce((t,r)=>t+(r.cost||0),0).toLocaleString(),"원"]})]})})]})});export{H as default};
