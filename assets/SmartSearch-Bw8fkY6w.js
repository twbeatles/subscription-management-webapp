import{j as r,S as v,X as E,a4 as R,q as L}from"./vendor-ui-B6CU6qF1.js";import{r as s}from"./vendor-react-DtEkOSI3.js";import{C as N,m as $}from"./index-XBRr7Ttx.js";const w="sub_manager_search_history",I=5,z=i=>i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");function H({isOpen:i,onClose:m,subscriptions:u=[],onSelectSubscription:b}){const[c,g]=s.useState(""),[n,h]=s.useState(0),[p,j]=s.useState([]),k=s.useRef(null),f=s.useRef(null);s.useEffect(()=>{try{const e=localStorage.getItem(w);e&&j(JSON.parse(e))}catch{}},[]),s.useEffect(()=>{i&&k.current&&(k.current.focus(),g(""),h(0))},[i]);const l=s.useMemo(()=>{if(!c.trim())return[];const e=c.toLowerCase();return u.filter(a=>{var t,o,x,d;return((t=a.name)==null?void 0:t.toLowerCase().includes(e))||((o=a.category)==null?void 0:o.toLowerCase().includes(e))||((x=N[a.category])==null?void 0:x.toLowerCase().includes(e))||((d=a.memo)==null?void 0:d.toLowerCase().includes(e))})},[c,u]),y=s.useCallback(e=>{if(e){const a=[e.name,...p.filter(t=>t!==e.name)].slice(0,I);j(a);try{localStorage.setItem(w,JSON.stringify(a))}catch{}b(e),m()}},[p,b,m]);s.useEffect(()=>{const e=a=>{if(i)switch(a.key){case"ArrowDown":a.preventDefault(),h(t=>Math.min(t+1,l.length-1));break;case"ArrowUp":a.preventDefault(),h(t=>Math.max(t-1,0));break;case"Enter":a.preventDefault(),l[n]&&y(l[n]);break;case"Escape":a.preventDefault(),m();break}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[i,l,n,y,m]),s.useEffect(()=>{if(f.current&&l.length>0){const e=f.current.children[n];e==null||e.scrollIntoView({block:"nearest"})}},[n,l.length]);const S=s.useCallback((e,a)=>{if(!a||!e)return e;try{const t=z(a),o=new RegExp(`(${t})`,"gi");return e.split(o).map((d,C)=>o.test(d)?r.jsx("mark",{className:"bg-primary-200 dark:bg-primary-800 text-primary-800 dark:text-primary-200 rounded px-0.5",children:d},C):d)}catch{return e}},[]);return i?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 animate-fade-in",onClick:m}),r.jsx("div",{className:"fixed inset-x-4 top-20 sm:inset-x-auto sm:left-1/2 sm:-translate-x-1/2 sm:w-full sm:max-w-lg z-50 animate-slide-up",children:r.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-dark-700 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-gray-100 dark:border-dark-700",children:[r.jsx(v,{size:20,className:"text-gray-400 dark:text-dark-400 flex-shrink-0"}),r.jsx("input",{ref:k,type:"text",value:c,onChange:e=>{g(e.target.value),h(0)},placeholder:"구독 검색... (이름, 카테고리, 메모)",className:"flex-1 bg-transparent text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-dark-400 outline-none text-base"}),c&&r.jsx("button",{onClick:()=>g(""),className:"p-1 hover:bg-gray-100 dark:hover:bg-dark-700 rounded-lg transition-colors",children:r.jsx(E,{size:16,className:"text-gray-400"})}),r.jsx("div",{className:"hidden sm:flex items-center gap-1 text-xs text-gray-400 dark:text-dark-500",children:r.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 dark:bg-dark-700 rounded text-[10px] font-mono",children:"ESC"})})]}),r.jsx("div",{ref:f,className:"max-h-80 overflow-y-auto thin-scrollbar",children:c.trim()?l.length>0?r.jsx("div",{className:"py-1",children:l.map((e,a)=>{var o,x;const t=$(e.name,e.url);return r.jsxs("button",{onClick:()=>y(e),className:`w-full flex items-center gap-3 px-4 py-3 text-left transition-all duration-200 group ${a===n?"bg-gradient-to-r from-primary-50 to-violet-50 dark:from-primary-900/30 dark:to-violet-900/20 border-l-2 border-primary-500":"hover:bg-gray-50 dark:hover:bg-dark-700/50 border-l-2 border-transparent"}`,children:[r.jsxs("div",{className:`relative w-11 h-11 rounded-2xl flex items-center justify-center text-white font-bold text-sm flex-shrink-0 shadow-lg transition-transform duration-200 overflow-hidden ${a===n?"scale-110":"group-hover:scale-105"}`,style:{background:`linear-gradient(135deg, ${e.customColor||"#6366f1"} 0%, ${e.customColor||"#8b5cf6"}CC 100%)`,boxShadow:`0 4px 12px -2px ${e.customColor||"#6366f1"}40`},children:[t?r.jsx("img",{src:t,alt:"",className:"w-6 h-6 object-contain",onError:d=>{d.target.style.display="none",d.target.nextSibling.style.display="block"}}):null,r.jsx("span",{className:t?"hidden":"block",children:(o=e.name)==null?void 0:o.slice(0,1).toUpperCase()})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:`font-semibold truncate transition-colors ${a===n?"text-primary-700 dark:text-primary-300":"text-gray-900 dark:text-white"}`,children:S(e.name,c)}),r.jsxs("div",{className:"text-sm text-gray-500 dark:text-dark-400 flex items-center gap-2",children:[r.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 dark:bg-dark-700 rounded text-xs",children:N[e.category]||e.category}),r.jsxs("span",{className:"font-medium",children:[(x=e.cost)==null?void 0:x.toLocaleString(),"원"]})]})]}),r.jsx(R,{size:18,className:`flex-shrink-0 transition-all duration-200 ${a===n?"text-primary-500 translate-x-1":"text-gray-300 dark:text-dark-500 group-hover:translate-x-1 group-hover:text-gray-400"}`})]},e.id)})}):r.jsxs("div",{className:"px-4 py-12 text-center",children:[r.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-gray-100 dark:bg-dark-700 flex items-center justify-center",children:r.jsx(v,{size:28,className:"text-gray-300 dark:text-dark-500"})}),r.jsxs("p",{className:"text-gray-500 dark:text-dark-400 font-medium",children:['"',c,'"에 대한 검색 결과가 없습니다']}),r.jsx("p",{className:"text-sm text-gray-400 dark:text-dark-500 mt-1",children:"다른 키워드로 검색해보세요"})]}):p.length>0&&r.jsxs("div",{className:"p-2",children:[r.jsx("div",{className:"px-2 py-1 text-xs font-medium text-gray-400 dark:text-dark-500 uppercase tracking-wider",children:"최근 검색"}),p.map((e,a)=>r.jsxs("button",{onClick:()=>g(e),className:"w-full flex items-center gap-3 px-3 py-2 text-left hover:bg-gray-50 dark:hover:bg-dark-700/50 rounded-lg transition-colors",children:[r.jsx(L,{size:14,className:"text-gray-400 dark:text-dark-500"}),r.jsx("span",{className:"text-gray-700 dark:text-dark-300",children:e})]},a))]})}),r.jsxs("div",{className:"hidden sm:flex items-center justify-between px-4 py-2 border-t border-gray-100 dark:border-dark-700 bg-gray-50/50 dark:bg-dark-900/50 text-xs text-gray-400 dark:text-dark-500",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 dark:bg-dark-700 rounded text-[10px]",children:"↑"}),r.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 dark:bg-dark-700 rounded text-[10px]",children:"↓"}),"탐색"]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 dark:bg-dark-700 rounded text-[10px]",children:"Enter"}),"선택"]})]}),r.jsxs("span",{children:[l.length,"개 결과"]})]})]})})]}):null}export{H as default};
