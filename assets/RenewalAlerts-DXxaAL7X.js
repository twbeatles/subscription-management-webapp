import{j as a,aw as u,p as g,I as m,v as N,u as b,k as R,e as v,l as C}from"./vendor-ui-B6CU6qF1.js";import{r as i}from"./vendor-react-DtEkOSI3.js";import{R as D}from"./index-XBRr7Ttx.js";function S({subscriptions:o}){const[x,h]=i.useState(null),[c,y]=i.useState(!1),l=i.useMemo(()=>o.filter(e=>!e.isPaused&&(e.isYearly||e.billingCycle==="yearly")).map(e=>{let t=e.renewalDate?new Date(e.renewalDate):null;!t&&e.billingDay&&(t=new Date,t.setMonth(t.getMonth()+12),t.setDate(e.billingDay));const r=t?Math.ceil((t-new Date)/(1e3*60*60*24)):null;let d="normal";return r!==null&&(r<=1?d="critical":r<=7?d="warning":r<=30&&(d="notice")),{...e,renewalDate:t,daysUntilRenewal:r,alertLevel:d,yearlyCost:(e.cost||0)*12,autoRenewal:e.autoRenewal!==!1}}).sort((e,t)=>(e.daysUntilRenewal||999)-(t.daysUntilRenewal||999)),[o]),s=l.filter(e=>e.daysUntilRenewal!==null&&e.daysUntilRenewal<=30),w=i.useMemo(()=>s.reduce((e,t)=>e+t.yearlyCost,0),[s]),p=e=>{switch(e){case"critical":return"bg-red-500 text-white";case"warning":return"bg-orange-500 text-white";case"notice":return"bg-yellow-500 text-white";default:return"bg-gray-200 dark:bg-dark-600 text-gray-600 dark:text-dark-300"}},f=e=>{switch(e){case"critical":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";case"warning":return"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800";case"notice":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";default:return"bg-gray-50 dark:bg-dark-700/50 border-gray-200 dark:border-dark-600"}},j=e=>e?e.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}):"-";if(l.length===0)return null;const k=c?l:l.slice(0,5);return a.jsxs("section",{className:"bg-white dark:bg-dark-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-dark-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-5",children:[a.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2.5 text-base",children:[a.jsx("div",{className:"p-2 rounded-lg bg-orange-50 dark:bg-orange-900/20 text-orange-500",children:a.jsx(u,{className:"w-5 h-5"})}),"갱신 알림"]}),a.jsxs("span",{className:"text-xs text-gray-400",children:["연간 구독 ",l.length,"개"]})]}),s.length>0&&a.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-orange-50 to-amber-50 dark:from-orange-900/20 dark:to-amber-900/20 rounded-2xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(g,{size:16,className:"text-orange-500"}),a.jsx("span",{className:"font-bold text-sm text-orange-700 dark:text-orange-400",children:"30일 내 갱신 예정"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("p",{className:"text-xs text-orange-600/70",children:[s.length,"개 구독 갱신 예정"]}),a.jsxs("span",{className:"text-sm font-bold text-orange-600",children:["₩",w.toLocaleString()]})]})]}),a.jsx("div",{className:"space-y-2",children:k.map(e=>{var t;return a.jsxs("div",{className:`rounded-2xl border overflow-hidden ${f(e.alertLevel)}`,children:[a.jsxs("button",{onClick:()=>h(x===e.id?null:e.id),className:"w-full flex items-center gap-3 p-4",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold text-sm",style:{backgroundColor:e.color||"#6366F1"},children:((t=e.name)==null?void 0:t.charAt(0))||"?"}),a.jsxs("div",{className:"flex-1 text-left",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"font-medium text-sm text-gray-800 dark:text-white",children:e.name}),e.autoRenewal?a.jsx(m,{size:12,className:"text-blue-500"}):a.jsx(N,{size:12,className:"text-gray-400"})]}),a.jsxs("p",{className:"text-xs text-gray-400",children:["연간 ₩",e.yearlyCost.toLocaleString()]})]}),a.jsx("div",{className:"text-right",children:e.daysUntilRenewal!==null?a.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded-full ${p(e.alertLevel)}`,children:e.daysUntilRenewal===0?"오늘!":e.daysUntilRenewal<0?"만료됨":`${e.daysUntilRenewal}일 후`}):a.jsx("span",{className:"text-xs text-gray-400",children:"날짜 미설정"})}),x===e.id?a.jsx(b,{size:16,className:"text-gray-400"}):a.jsx(R,{size:16,className:"text-gray-400"})]}),x===e.id&&a.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/50 dark:bg-dark-800/50 rounded-xl",children:[a.jsx(v,{size:16,className:"text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"갱신일"}),a.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-white",children:j(e.renewalDate)})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/50 dark:bg-dark-800/50 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(m,{size:16,className:"text-gray-400"}),a.jsx("span",{className:"text-sm text-gray-700 dark:text-dark-200",children:"자동 갱신"})]}),a.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${e.autoRenewal?"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-500 dark:bg-dark-600 dark:text-dark-400"}`,children:e.autoRenewal?"ON":"OFF"})]}),a.jsxs("div",{className:"p-3 bg-white/50 dark:bg-dark-800/50 rounded-xl",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"알림 예정"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:D.map(n=>{const r=e.daysUntilRenewal!==null&&e.daysUntilRenewal<n;return a.jsxs("span",{className:`text-[10px] px-2 py-1 rounded-full ${r?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"bg-gray-200 text-gray-500 dark:bg-dark-600 dark:text-dark-400"}`,children:[r&&a.jsx(C,{size:10,className:"inline mr-1"}),n,"일 전"]},n)})})]}),e.autoRenewal&&e.daysUntilRenewal!==null&&e.daysUntilRenewal<=7&&a.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-xl",children:a.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 flex items-center gap-2",children:[a.jsx(g,{size:14}),"자동 갱신이 켜져 있습니다. 해지하려면 갱신일 전에 취소하세요."]})})]})]},e.id)})}),l.length>5&&a.jsx("button",{onClick:()=>y(!c),className:"w-full mt-4 py-3 text-center text-sm text-primary-500 hover:text-primary-600",children:c?"접기":`${l.length-5}개 더 보기`})]})}export{S as default};
