import{j as e,t as j,D as A,s as L,l as F,X as M,n as I,aE as T,_ as U,y as q}from"./vendor-ui-B6CU6qF1.js";import{r as n}from"./vendor-react-DtEkOSI3.js";function X({subscriptions:y,userId:o,onUpdateSubscription:J}){const[i,g]=n.useState([]),[N,w]=n.useState(null),[h,S]=n.useState(""),[C,u]=n.useState(!1),[b,k]=n.useState(""),[c,v]=n.useState("");n.useEffect(()=>{if(o)try{const t=localStorage.getItem(`family_groups_${o}`);t&&g(JSON.parse(t))}catch{g([])}},[o]);const x=t=>{if(g(t),o)try{localStorage.setItem(`family_groups_${o}`,JSON.stringify(t))}catch{}},z=y.filter(t=>!t.isPaused&&!i.some(s=>s.subscriptionId===t.id)),O=()=>{if(!b.trim()||!c)return;const t=y.find(d=>d.id===c);if(!t)return;const s={id:`fg_${Date.now()}`,name:b.trim(),subscriptionId:c,subscriptionName:t.name,totalCost:t.cost,members:[{id:"owner",name:"나 (소유자)",share:100,isOwner:!0}],createdAt:new Date().toISOString()};x([...i,s]),k(""),v(""),u(!1)},_=t=>{if(!h.trim())return;const s=i.map(d=>{if(d.id===t){const r={id:`m_${Date.now()}`,name:h.trim(),share:0,isOwner:!1},a=[...d.members,r],l=Math.floor(100/a.length),f=100-l*a.length;return{...d,members:a.map((m,p)=>({...m,share:l+(p===0?f:0)}))}}return d});x(s),S("")},E=(t,s)=>{const d=i.map(r=>{if(r.id===t){const a=r.members.filter(m=>m.id!==s),l=Math.floor(100/a.length),f=100-l*a.length;return{...r,members:a.map((m,p)=>({...m,share:l+(p===0?f:0)}))}}return r});x(d)},D=(t,s,d)=>{const r=i.map(a=>a.id===t?{...a,members:a.members.map(l=>l.id===s?{...l,share:Math.max(0,Math.min(100,d))}:l)}:a);x(r)},P=t=>{x(i.filter(s=>s.id!==t))},G=(t,s)=>Math.round(t*(s/100)),$=()=>i.reduce((t,s)=>{const d=s.members.filter(r=>!r.isOwner).reduce((r,a)=>r+G(s.totalCost,a.share),0);return t+d},0);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-xl bg-violet-100 dark:bg-violet-900/30 text-violet-600 dark:text-violet-400",children:e.jsx(j,{size:20})}),"가족/그룹 구독 관리"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-dark-400 mt-1",children:"가족 요금제 비용을 분담하고 관리하세요"})]})}),i.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-violet-500 to-purple-600 rounded-2xl p-5 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-violet-100 text-sm",children:"다른 멤버로부터 받을 금액"}),e.jsxs("p",{className:"text-3xl font-bold mt-1",children:["₩",$().toLocaleString(),e.jsx("span",{className:"text-sm font-normal text-violet-200",children:"/월"})]})]}),e.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:e.jsx(A,{size:28})})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/20 text-sm text-violet-100",children:[i.length,"개 그룹 · ",i.reduce((t,s)=>t+s.members.length,0),"명 멤버"]})]}),C?e.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-2xl p-5 border border-gray-200 dark:border-dark-700 space-y-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"새 가족 그룹"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-dark-300 mb-1",children:"그룹 이름"}),e.jsx("input",{type:"text",value:b,onChange:t=>k(t.target.value),placeholder:"예: 넷플릭스 가족",className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 dark:border-dark-600 bg-gray-50 dark:bg-dark-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-violet-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-dark-300 mb-1",children:"연결할 구독"}),e.jsxs("select",{value:c,onChange:t=>v(t.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 dark:border-dark-600 bg-gray-50 dark:bg-dark-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-violet-500 outline-none",children:[e.jsx("option",{value:"",children:"구독 선택..."}),z.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (₩",t.cost.toLocaleString(),"/월)"]},t.id))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:O,disabled:!b.trim()||!c,className:"flex-1 py-2.5 bg-violet-600 hover:bg-violet-700 disabled:bg-gray-300 dark:disabled:bg-dark-600 text-white rounded-xl font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(F,{size:18}),"만들기"]}),e.jsx("button",{onClick:()=>{u(!1),k(""),v("")},className:"px-4 py-2.5 bg-gray-100 dark:bg-dark-700 text-gray-600 dark:text-dark-300 rounded-xl font-medium hover:bg-gray-200 dark:hover:bg-dark-600 transition-colors",children:e.jsx(M,{size:18})})]})]}):e.jsxs("button",{onClick:()=>u(!0),className:"w-full py-4 border-2 border-dashed border-gray-300 dark:border-dark-600 rounded-2xl text-gray-500 dark:text-dark-400 hover:border-violet-400 hover:text-violet-500 dark:hover:border-violet-500 dark:hover:text-violet-400 transition-all flex items-center justify-center gap-2 font-medium",children:[e.jsx(L,{size:20}),"새 가족 그룹 만들기"]}),e.jsx("div",{className:"space-y-4",children:i.map(t=>{const s=t.members.reduce((r,a)=>r+a.share,0),d=s===100;return e.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-2xl border border-gray-200 dark:border-dark-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center text-violet-600 dark:text-violet-400",children:e.jsx(j,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-dark-400",children:[t.subscriptionName," · ₩",t.totalCost.toLocaleString(),"/월"]})]})]}),e.jsx("button",{onClick:()=>P(t.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:e.jsx(I,{size:16})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[t.members.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-dark-700 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${r.isOwner?"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-gray-200 text-gray-600 dark:bg-dark-600 dark:text-dark-300"}`,children:r.isOwner?e.jsx(T,{size:14}):r.name.charAt(0)}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx("input",{type:"number",value:r.share,onChange:a=>D(t.id,r.id,parseInt(a.target.value)||0),className:"w-14 px-2 py-1 text-center rounded-lg border border-gray-200 dark:border-dark-600 bg-white dark:bg-dark-800 text-gray-900 dark:text-white",min:"0",max:"100"}),e.jsx(U,{size:14,className:"text-gray-400"})]}),e.jsxs("span",{className:"text-sm font-medium text-violet-600 dark:text-violet-400 min-w-[80px] text-right",children:["₩",G(t.totalCost,r.share).toLocaleString()]}),!r.isOwner&&e.jsx("button",{onClick:()=>E(t.id,r.id),className:"p-1.5 text-gray-400 hover:text-red-500 rounded-lg transition-colors",children:e.jsx(M,{size:14})})]})]},r.id)),!d&&e.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-900/20 px-3 py-2 rounded-lg",children:["⚠️ 분담 비율 합계: ",s,"% (100%가 되어야 합니다)"]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("input",{type:"text",value:N===t.id?h:"",onChange:r=>{w(t.id),S(r.target.value)},onFocus:()=>w(t.id),placeholder:"새 멤버 이름",className:"flex-1 px-3 py-2 rounded-lg border border-gray-200 dark:border-dark-600 bg-white dark:bg-dark-800 text-gray-900 dark:text-white text-sm"}),e.jsxs("button",{onClick:()=>_(t.id),disabled:N!==t.id||!h.trim(),className:"px-4 py-2 bg-violet-100 dark:bg-violet-900/30 text-violet-600 dark:text-violet-400 rounded-lg font-medium hover:bg-violet-200 dark:hover:bg-violet-900/50 transition-colors disabled:opacity-50 flex items-center gap-1",children:[e.jsx(q,{size:16}),"추가"]})]})]})]},t.id)})}),i.length===0&&!C&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-violet-100 dark:bg-violet-900/30 text-violet-500 mb-4",children:e.jsx(j,{size:32})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"가족 그룹이 없습니다"}),e.jsxs("p",{className:"text-gray-500 dark:text-dark-400 mb-4",children:["Netflix, YouTube Premium 등 가족 요금제를",e.jsx("br",{}),"분담해서 관리해보세요!"]})]})]})}export{X as default};
