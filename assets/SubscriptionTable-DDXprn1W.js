import{j as e,az as T,S as _,r as $,aA as B,u as G,k as P}from"./vendor-ui-B6CU6qF1.js";import{r as n}from"./vendor-react-DtEkOSI3.js";import{U as q,C as w,a as C,V as k}from"./index-XBRr7Ttx.js";function W({subscriptions:d,onEdit:y}){const[g,L]=n.useState("name"),[o,N]=n.useState("asc"),[m,M]=n.useState(""),[h,A]=n.useState(null),[i,E]=n.useState(!1),[c,b]=n.useState([]),[j,F]=n.useState(!1),x=n.useMemo(()=>d.map(t=>{var S;const r=((S=q[t.usageFrequency||"weekly"])==null?void 0:S.value)||8,l=Math.min(100,r*3.33),a=t.satisfaction||70,s=15e3,v=Math.max(0,Math.min(100,((s-(t.cost||0))/s+1)*50)),U=Math.round(l*k.usageFrequency+a*k.satisfaction+v*k.priceValue);return{...t,usageScore:l,satisfactionScore:a,priceScore:v,valueScore:U}}),[d]),f=n.useMemo(()=>{let t=[...x];if(m){const r=m.toLowerCase();t=t.filter(l=>{var a,s;return((a=l.name)==null?void 0:a.toLowerCase().includes(r))||((s=l.category)==null?void 0:s.toLowerCase().includes(r))})}return h&&(t=t.filter(r=>r.category===h)),t.sort((r,l)=>{let a,s;switch(g){case"name":a=r.name||"",s=l.name||"";break;case"cost":a=r.cost||0,s=l.cost||0;break;case"valueScore":a=r.valueScore||0,s=l.valueScore||0;break;case"category":a=r.category||"",s=l.category||"";break;case"daysLeft":a=r.daysLeft??999,s=l.daysLeft??999;break;default:a=r.name||"",s=l.name||""}return typeof a=="string"?o==="asc"?a.localeCompare(s):s.localeCompare(a):o==="asc"?a-s:s-a}),t},[x,m,h,g,o]),p=t=>{g===t?N(o==="asc"?"desc":"asc"):(L(t),N("asc"))},O=t=>{c.includes(t)?b(c.filter(r=>r!==t)):c.length<3&&b([...c,t])},V=n.useMemo(()=>[...new Set(d.map(t=>t.category).filter(Boolean))],[d]),z=x.filter(t=>c.includes(t.id)),R=t=>t>=80?"text-green-500 bg-green-50 dark:bg-green-900/20":t>=60?"text-blue-500 bg-blue-50 dark:bg-blue-900/20":t>=40?"text-yellow-500 bg-yellow-50 dark:bg-yellow-900/20":"text-red-500 bg-red-50 dark:bg-red-900/20",u=({column:t})=>g!==t?e.jsx(B,{size:12,className:"text-gray-300"}):o==="asc"?e.jsx(G,{size:12,className:"text-primary-500"}):e.jsx(P,{size:12,className:"text-primary-500"});return d.length===0?null:e.jsxs("section",{className:"bg-white dark:bg-dark-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-dark-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2.5 text-base",children:[e.jsx("div",{className:"p-2 rounded-lg bg-indigo-50 dark:bg-indigo-900/20 text-indigo-500",children:e.jsx(T,{className:"w-5 h-5"})}),"구독 비교 테이블"]}),e.jsx("button",{onClick:()=>F(!j),className:"text-xs text-primary-500 hover:text-primary-600",children:j?"접기":"펼치기"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-400",children:"총 구독"}),e.jsxs("p",{className:"text-lg font-bold text-gray-800 dark:text-white",children:[d.length,"개"]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-400",children:"월 총액"}),e.jsxs("p",{className:"text-lg font-bold text-primary-600 dark:text-primary-400",children:["₩",d.filter(t=>!t.isPaused).reduce((t,r)=>t+(r.cost||0),0).toLocaleString()]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-400",children:"평균 가치"}),e.jsxs("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[Math.round(x.reduce((t,r)=>t+r.valueScore,0)/x.length||0),"점"]})]})]}),j&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(_,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:m,onChange:t=>M(t.target.value),placeholder:"검색...",className:"w-full pl-9 pr-3 py-2 bg-gray-100 dark:bg-dark-700 rounded-xl text-sm outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("select",{value:h||"",onChange:t=>A(t.target.value||null),className:"px-3 py-2 bg-gray-100 dark:bg-dark-700 rounded-xl text-sm outline-none",children:[e.jsx("option",{value:"",children:"전체"}),V.map(t=>e.jsx("option",{value:t,children:w[t]||t},t))]}),e.jsx("button",{onClick:()=>E(!i),className:`px-3 py-2 rounded-xl text-xs font-medium transition-all ${i?"bg-primary-500 text-white":"bg-gray-100 dark:bg-dark-700 text-gray-600 dark:text-dark-300"}`,children:"비교"})]}),i&&c.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl",children:[e.jsxs("p",{className:"text-xs font-medium text-indigo-700 dark:text-indigo-400 mb-3",children:["선택된 구독 비교 (",c.length,"/3)"]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:z.map(t=>{var r;return e.jsxs("div",{className:"p-3 bg-white dark:bg-dark-800 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center text-white text-[10px] font-bold",style:{backgroundColor:t.color||"#6366F1"},children:(r=t.name)==null?void 0:r.charAt(0)}),e.jsx("span",{className:"text-xs font-medium text-gray-800 dark:text-white truncate",children:t.name})]}),e.jsxs("div",{className:"space-y-1 text-[10px]",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"가격"}),e.jsxs("span",{className:"font-medium",children:["₩",(t.cost||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"가치점수"}),e.jsx("span",{className:`font-bold ${t.valueScore>=60?"text-green-500":"text-red-500"}`,children:t.valueScore})]})]})]},t.id)})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100 dark:border-dark-700",children:[i&&e.jsx("th",{className:"p-2 w-8"}),e.jsx("th",{className:"p-2 text-left cursor-pointer hover:bg-gray-50 dark:hover:bg-dark-700",onClick:()=>p("name"),children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:["서비스 ",e.jsx(u,{column:"name"})]})}),e.jsx("th",{className:"p-2 text-left cursor-pointer hover:bg-gray-50 dark:hover:bg-dark-700",onClick:()=>p("category"),children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:["카테고리 ",e.jsx(u,{column:"category"})]})}),e.jsx("th",{className:"p-2 text-right cursor-pointer hover:bg-gray-50 dark:hover:bg-dark-700",onClick:()=>p("cost"),children:e.jsxs("div",{className:"flex items-center justify-end gap-1 text-xs text-gray-500",children:["월 비용 ",e.jsx(u,{column:"cost"})]})}),e.jsx("th",{className:"p-2 text-center cursor-pointer hover:bg-gray-50 dark:hover:bg-dark-700",onClick:()=>p("valueScore"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-gray-500",children:["가치 ",e.jsx(u,{column:"valueScore"})]})}),e.jsx("th",{className:"p-2 w-10"})]})}),e.jsx("tbody",{children:f.slice(0,10).map(t=>{var r;return e.jsxs("tr",{className:`border-b border-gray-50 dark:border-dark-700 hover:bg-gray-50 dark:hover:bg-dark-700/50 ${t.isPaused?"opacity-50":""}`,children:[i&&e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"checkbox",checked:c.includes(t.id),onChange:()=>O(t.id),disabled:!c.includes(t.id)&&c.length>=3,className:"w-4 h-4 rounded border-gray-300"})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center text-white text-[10px] font-bold",style:{backgroundColor:t.color||"#6366F1"},children:(r=t.name)==null?void 0:r.charAt(0)}),e.jsx("span",{className:"font-medium text-gray-800 dark:text-white",children:t.name})]})}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:"text-xs px-2 py-1 rounded-full",style:{backgroundColor:`${C[t.category]}20`,color:C[t.category]},children:w[t.category]||t.category})}),e.jsxs("td",{className:"p-2 text-right font-medium text-gray-800 dark:text-white",children:["₩",(t.cost||0).toLocaleString()]}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded-full ${R(t.valueScore)}`,children:t.valueScore})}),e.jsx("td",{className:"p-2",children:e.jsx("button",{onClick:()=>y==null?void 0:y(t),className:"p-1.5 text-gray-400 hover:text-primary-500 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-600",children:e.jsx($,{size:14})})})]},t.id)})})]})}),f.length>10&&e.jsxs("p",{className:"text-xs text-gray-400 text-center mt-3",children:["+",f.length-10,"개 더 있음"]})]})]})}export{W as default};
