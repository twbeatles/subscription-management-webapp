import{j as t,B as E,p as w,aF as D,E as h,aG as C,q as S,N as k,ao as I}from"./vendor-ui-B6CU6qF1.js";import{r as l}from"./vendor-react-DtEkOSI3.js";import{g as R}from"./index-XBRr7Ttx.js";function L({subscriptions:d}){const[n,y]=l.useState(()=>{try{const e=localStorage.getItem("dismissed_cancel_reminders");return e?JSON.parse(e):[]}catch{return[]}});l.useEffect(()=>{try{localStorage.setItem("dismissed_cancel_reminders",JSON.stringify(n))}catch{}},[n]);const i=l.useMemo(()=>d.filter(e=>e.trialEndDate&&!e.isPaused).map(e=>({...e,daysUntilEnd:R(e.trialEndDate)})).filter(e=>e.daysUntilEnd>=0&&e.daysUntilEnd<=14).sort((e,r)=>e.daysUntilEnd-r.daysUntilEnd),[d]),f=l.useMemo(()=>d.filter(r=>!r.isPaused).filter(r=>!i.some(a=>a.id===r.id)).sort((r,a)=>a.cost-r.cost).slice(0,3),[d,i]),b=e=>{const r=new Date(e.trialEndDate),a=new Date(r);a.setDate(a.getDate()-1);const g=v=>v.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",p=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Subscription Manager//KO
BEGIN:VEVENT
UID:${e.id}@subscription-manager
DTSTART:${g(a)}
DTEND:${g(a)}
SUMMARY:⚠️ ${e.name} 무료 체험 종료 예정
DESCRIPTION:${e.name}의 무료 체험이 내일 종료됩니다. 계속 사용하지 않으시면 해지하세요!
BEGIN:VALARM
ACTION:DISPLAY
TRIGGER:-PT1H
DESCRIPTION:${e.name} 체험 종료 1시간 전
END:VALARM
END:VEVENT
END:VCALENDAR`,N=new Blob([p],{type:"text/calendar;charset=utf-8"}),m=URL.createObjectURL(N),s=document.createElement("a");s.href=m,s.download=`${e.name}_체험종료.ics`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(m)},x=e=>{y(r=>[...r,e])},j=e=>e<=1?"text-red-500 bg-red-50 dark:bg-red-900/20":e<=3?"text-orange-500 bg-orange-50 dark:bg-orange-900/20":e<=7?"text-yellow-500 bg-yellow-50 dark:bg-yellow-900/20":"text-blue-500 bg-blue-50 dark:bg-blue-900/20",u=e=>e===0?"오늘 종료":e===1?"내일 종료":`${e}일 후 종료`,o=i.filter(e=>!n.includes(e.id)),c=f.filter(e=>!n.includes(`low_${e.id}`));return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx("div",{className:"p-2 rounded-xl bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400",children:t.jsx(E,{size:20})}),"해지 리마인더"]}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-dark-400 mt-1",children:"무료 체험 종료와 해지 검토가 필요한 구독"})]})}),o.length>0&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("h4",{className:"text-sm font-semibold text-gray-700 dark:text-dark-300 flex items-center gap-2",children:[t.jsx(w,{size:16,className:"text-amber-500"}),"무료 체험 종료 예정"]}),o.map(e=>{var r;return t.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-2xl border border-gray-200 dark:border-dark-700 p-4 hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:e.customColor||"#6366F1"},children:e.name.charAt(0)}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-gray-900 dark:text-white",children:e.name}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-dark-400",children:["결제 시 ₩",(r=e.cost)==null?void 0:r.toLocaleString(),"/월"]})]})]}),t.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${j(e.daysUntilEnd)}`,children:u(e.daysUntilEnd)})]}),t.jsxs("div",{className:"flex gap-2 mt-4",children:[t.jsxs("button",{onClick:()=>b(e),className:"flex-1 py-2.5 px-4 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-xl text-sm font-medium hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors flex items-center justify-center gap-2",children:[t.jsx(D,{size:16}),"캘린더에 추가"]}),e.url&&t.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"py-2.5 px-4 bg-gray-100 dark:bg-dark-700 text-gray-600 dark:text-dark-300 rounded-xl text-sm font-medium hover:bg-gray-200 dark:hover:bg-dark-600 transition-colors flex items-center gap-2",children:[t.jsx(h,{size:16}),"해지하기"]}),t.jsx("button",{onClick:()=>x(e.id),className:"p-2.5 text-gray-400 hover:text-gray-600 dark:hover:text-dark-300 rounded-xl hover:bg-gray-100 dark:hover:bg-dark-700 transition-colors",title:"알림 숨기기",children:t.jsx(C,{size:16})})]})]},e.id)})]}),c.length>0&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("h4",{className:"text-sm font-semibold text-gray-700 dark:text-dark-300 flex items-center gap-2",children:[t.jsx(S,{size:16,className:"text-gray-500"}),"해지 검토 추천 (고비용 순)"]}),c.map(e=>{var r;return t.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-xl border border-gray-200 dark:border-dark-700 p-3 flex items-center justify-between group hover:border-gray-300 dark:hover:border-dark-600 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold",style:{backgroundColor:e.customColor||"#6366F1"},children:e.name.charAt(0)}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium text-gray-900 dark:text-white text-sm",children:e.name}),t.jsxs("p",{className:"text-xs text-gray-500 dark:text-dark-400",children:["₩",(r=e.cost)==null?void 0:r.toLocaleString(),"/월"]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[e.url&&t.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"opacity-0 group-hover:opacity-100 p-2 text-gray-400 hover:text-gray-600 dark:hover:text-dark-300 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-700 transition-all",children:t.jsx(h,{size:14})}),t.jsx("button",{onClick:()=>x(`low_${e.id}`),className:"opacity-0 group-hover:opacity-100 p-2 text-gray-400 hover:text-gray-600 dark:hover:text-dark-300 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-700 transition-all",children:t.jsx(k,{size:14})}),t.jsx(I,{size:16,className:"text-gray-300 dark:text-dark-600"})]})]},e.id)})]}),o.length===0&&c.length===0&&t.jsxs("div",{className:"text-center py-12 bg-green-50 dark:bg-green-900/10 rounded-2xl",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 mb-4",children:t.jsx(k,{size:32})}),t.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"모든 구독이 정상입니다!"}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-dark-400",children:"종료 예정인 체험이나 검토가 필요한 구독이 없습니다."})]})]})}export{L as default};
