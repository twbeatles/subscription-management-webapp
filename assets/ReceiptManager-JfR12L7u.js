import{j as e,ak as b,al as k,D as N,x as y,X as v,F as p,am as w}from"./vendor-ui-B6CU6qF1.js";import{r as c}from"./vendor-react-DtEkOSI3.js";function R({subscriptions:l,onUpdateReceipt:x}){const[F,P]=c.useState(null),[r,o]=c.useState(null),i=c.useRef(null),n=l.filter(t=>t.receipts&&t.receipts.length>0);l.filter(t=>!t.receipts||t.receipts.length===0);const h=async(t,a)=>{var g;const s=(g=t.target.files)==null?void 0:g[0];if(!s)return;if(!["image/jpeg","image/png","image/gif","application/pdf"].includes(s.type)){alert("JPG, PNG, GIF 또는 PDF 파일만 업로드 가능합니다.");return}if(s.size>5*1024*1024){alert("파일 크기는 5MB 이하여야 합니다.");return}const d=new FileReader;d.onloadend=()=>{const u={id:`receipt_${Date.now()}`,name:s.name,type:s.type,data:d.result,uploadedAt:new Date().toISOString()};x&&x(a,u)},d.readAsDataURL(s),i.current&&(i.current.value="")},f=t=>{o(t.data)},m=()=>{o(null)},j=t=>t.startsWith("image/")?w:p;return e.jsxs("section",{className:"bg-white dark:bg-dark-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-dark-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2.5 text-base",children:[e.jsx("div",{className:"p-2 rounded-lg bg-teal-50 dark:bg-teal-900/20 text-teal-500",children:e.jsx(b,{className:"w-5 h-5"})}),"영수증 관리"]}),e.jsxs("span",{className:"text-xs font-medium text-gray-500 dark:text-dark-400 bg-gray-100 dark:bg-dark-700 px-2.5 py-1 rounded-full",children:[n.length,"개 첨부됨"]})]}),n.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2",children:"첨부된 영수증"}),e.jsx("div",{className:"space-y-2",children:n.map(t=>e.jsxs("div",{className:"p-3 rounded-xl bg-teal-50 dark:bg-teal-900/20 border border-teal-200 dark:border-teal-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-sm text-gray-800 dark:text-white",children:t.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t.receipts.length,"개 파일"]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:t.receipts.map(a=>{const s=j(a.type);return e.jsxs("button",{onClick:()=>f(a),className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-dark-800 rounded-lg hover:bg-gray-50 dark:hover:bg-dark-700 transition-colors",children:[e.jsx(s,{size:14,className:"text-teal-500"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-dark-300 max-w-[100px] truncate",children:a.name}),e.jsx(k,{size:12,className:"text-gray-400"})]},a.id)})})]},t.id))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2",children:"영수증 추가"}),e.jsx("div",{className:"space-y-2",children:l.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-gray-50 dark:bg-dark-700/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:t.customColor||"#6366F1"},children:t.name[0]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm text-gray-800 dark:text-white block",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-400",children:[e.jsx(N,{size:10}),t.cost.toLocaleString(),"원",t.receipts&&t.receipts.length>0&&e.jsxs("span",{className:"text-teal-500 ml-1",children:["• ",t.receipts.length,"개 첨부"]})]})]})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{ref:i,type:"file",accept:"image/*,.pdf",onChange:a=>h(a,t.id),className:"hidden"}),e.jsx("div",{className:"p-2 rounded-lg bg-gray-200 dark:bg-dark-600 text-gray-500 dark:text-dark-300 hover:bg-teal-100 dark:hover:bg-teal-900/30 hover:text-teal-600 dark:hover:text-teal-400 transition-colors",children:e.jsx(y,{size:14})})]})]},t.id))}),e.jsx("p",{className:"text-[10px] text-gray-400 dark:text-dark-500 mt-3 text-center",children:"JPG, PNG, GIF, PDF 지원 • 최대 5MB"})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:m,children:e.jsxs("div",{className:"relative max-w-3xl max-h-[90vh] overflow-auto",children:[e.jsx("button",{onClick:m,className:"absolute top-2 right-2 p-2 bg-white/10 rounded-full text-white hover:bg-white/20 transition-colors",children:e.jsx(v,{size:20})}),r.startsWith("data:image")?e.jsx("img",{src:r,alt:"Receipt preview",className:"max-w-full rounded-lg"}):e.jsxs("div",{className:"bg-white p-8 rounded-lg text-center",children:[e.jsx(p,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"PDF 미리보기는 지원되지 않습니다"}),e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"mt-4 inline-block px-4 py-2 bg-teal-500 text-white rounded-lg",children:"다운로드"})]})]})})]})}export{R as default};
